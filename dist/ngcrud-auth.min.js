/*! ng-crud-auth 2015-08-19 */
!function(a){var b=a.module("authModule",["restangular","ngCookies","ngRoute"]);b.constant("defaultStatus",{status:!1}),b.config(["RestangularProvider",function(a){a.setBaseUrl("webresources")}]),b.config(["$routeProvider",function(a){a.when("/login",{templateUrl:"src/templates/login.html",controller:"authController",controllerAs:"authCtrl"}).when("/register",{templateUrl:"src/templates/register.html",controller:"authController",controllerAs:"authCtrl"})}]),b.run(["Restangular","authService",function(a,b){a.setErrorInterceptor(function(a){return 401===a.status?(b.goToLogin(),!1):!0})}])}(window.angular),function(a){var b=a.module("authModule");b.provider("authService",function(){var a={apiUrl:"users",successPath:"/product",loginPath:"/login",registerPath:"/register",logoutRedirect:"/login",loginURL:"login",registerURL:"register",logoutURL:"logout",nameCookie:"user"};this.setValues=function(b){a=b},this.getValues=function(){return a},this.$get=["Restangular","$cookies","$location",function(b,c,d){var e=this;return this.api=b.all(a.apiUrl),{login:function(b){return e.api.customPOST(b,a.loginURL).then(function(b){c.putObject(a.nameCookie,{userName:b.name,id:b.id}),d.path(a.successPath)})},getConf:function(){return a},logout:function(){return e.api.customGET(a.logoutURL).then(function(){c.remove(a.nameCookie),d.path(a.logoutRedirect)})},register:function(b){return e.api.customPOST(b,a.registerURL).then(function(b){d.path(a.loginPath)})},registration:function(){d.path(a.registerPath)},getCurrentUser:function(){var b=c.getObject(a.nameCookie);return b?{id:b.id,name:b.userName}:null},goToLogin:function(){d.path(a.loginPath)},goToBack:function(){d.path(a.loginPath)}}}]})}(window.angular),function(a){var b=a.module("authModule");b.controller("authController",["$scope","$cookies","$location","authService","defaultStatus",function(a,b,c,d,e){this.errorctrl=e,a.isAuthenticated=function(){return!!d.getCurrentUser()},a.currentUser=function(){var a=d.getCurrentUser();return a&&a.name},this.login=function(a){var b=this;a&&a.userName&&a.password&&d.login(a).then(function(a){console.log("success",a)},function(a){b.errorctrl={status:!0,type:"danger",msg:":"+a.data}})},a.logout=function(){d.logout()},this.close=function(){this.errorctrl=e},this.registration=function(){d.registration()},this.register=function(a){var b=this;a.password!==a.confirmPassword?this.errorctrl={status:!0,type:"warning",msg:": Passwords must be equals"}:d.register(a).then(function(a){b.errorctrl={status:!0,type:"success",msg:": User registered successfully"}},function(a){b.errorctrl={status:!0,type:"danger",msg:":"+a.data}})},a.goToLogin=function(){d.goToLogin()},this.goBack=function(){d.goToBack()}}])}(window.angular),function(a){var b=a.module("authModule");b.directive("loginButton",[function(){return{scope:{},restrict:"E",templateUrl:"src/templates/button.html",controller:"authController"}}])}(window.angular),angular.module("authModule").run(["$templateCache",function(a){"use strict";a.put("src/templates/button.html",'<button ng-hide="isAuthenticated()" type="button" class="btn btn-default navbar-btn" ng-click="goToLogin()"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> Login</button><div ng-show="isAuthenticated()" class="btn-group"><button type="button" class="btn btn-default dropdown-toggle navbar-btn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{currentUser()}} <span class="caret"></span></button><ul class="dropdown-menu"><li><a href ng-click="logout()"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> Logout</a></li></ul></div>'),a.put("src/templates/login.html",'<div><div class="col-md-5 col-md-offset-4"><div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Please Login</h3><div class="col-md-12" ng-show="authCtrl.errorctrl.status" ng-message="show"><div class="alert alert-{{authCtrl.errorctrl.type}}" role="alert"><button type="button" class="close" ng-click="authCtrl.close()" aria-label="Close"><span aria-hidden="true">&times;</span></button> <strong>{{authCtrl.errorctrl.type| uppercase}}</strong> {{authCtrl.errorctrl.msg}}</div></div></div><div class="panel-body"><form name="loginform" accept-charset="UTF-8" role="form"><div class="form-group"><input class="form-control" required ng-model="user.userName" placeholder="Username or Email" name="username" type="text"></div><div class="form-group"><input class="form-control" required ng-model="user.password" placeholder="Password" name="password" type="password"></div><div class="checkbox"><label><input name="rememberMe" type="checkbox" ng-model="user.rememberMe" value="false"> Remember Me</label></div><input class="btn btn-lg btn-success btn-block" ng-click="authCtrl.login(user)" type="submit" value="Login"></form><button class="btn btn-lg btn-default btn-block" ng-click="authCtrl.registration()">Register</button></div></div></div></div>'),a.put("src/templates/register.html",'<div><div class="col-md-5 col-md-offset-4"><div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Please Register</h3><div style="padding-top: 30px" class="col-md-12" ng-show="authCtrl.errorctrl.status" ng-message="show"><div class="alert alert-{{authCtrl.errorctrl.type}}" role="alert"><button type="button" class="close" ng-click="authCtrl.close()" aria-label="Close"><span aria-hidden="true">&times;</span></button> <strong>{{authCtrl.errorctrl.type| uppercase}}</strong> {{authCtrl.errorctrl.msg}}</div></div></div><div class="panel-body"><form name="loginform" accept-charset="UTF-8" role="form"><div class="form-group"><input class="form-control" required ng-model="user.userName" placeholder="Username" name="username" type="text"></div><div class="form-group"><input class="form-control" required ng-model="user.password" placeholder="Password" name="password" type="password"></div><div class="form-group"><input class="form-control" required ng-model="user.confirmPassword" placeholder="Confirm Password" name="confirmpassword" type="password"></div><div class="form-group"><input class="form-control" required ng-model="user.name" placeholder="Name" name="name" type="text"></div><div class="form-group"><input class="form-control" required ng-model="user.lastName" placeholder="LastName" name="lastname" type="text"></div><div class="form-group"><input class="form-control" required ng-model="user.email" placeholder="email" name="email" type="email"></div><input class="btn btn-lg btn-primary btn-block" ng-click="authCtrl.register(user)" type="submit" value="Register"> <input class="btn btn-lg btn-default btn-block" ng-click="authCtrl.goBack()" type="submit" value="Go Back"></form></div></div></div></div>')}]);